<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>deviceConfig</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/bm.css">
    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/bminterface.js"></script>

    <style type="text/css">

    </style>

    <script>
        function getTime(id) {
            var idtime = $("#" + id).val();
            
            return idtime.split("T")[0] + " " + idtime.split("T")[1];
        }

        //function showimage(date, path, reason) {
        //    var inpath = "/opt/vehicle/vehicle_photo/" + date + "/" + path;
        //    bm_ajax("GetPhotoImage", "&path=" + inpath, function (json) {
        //        if (json["return"]) {
        //            $("#photoImage").attr('src', json["value"]);
        //            $('#myModal_image').modal('show');
        //        }
        //    });
        //}

        function showimage2(imgUrl) {
            window.open(imgUrl);
        }

        function paddInfoMingXi(reason,zplx) {

            bm_ajax("GetPassErrDetails", "&startTime=" + getTime("startTime") + "&endTime=" + getTime("endTime") + "&reason=" + reason + "&zplx=" + zplx, function (json) {
                if (json["return"]) {
                    //var eventJson = {
                    //    "tr_cbName": "showimage",
                    //    "tr_paramKeyList": [
                    //        { "paramKey": "日期" },
                    //        { "paramKey": "图片名称" },
                    //        { "paramKey": "说明" }
                    //    ],
                    //}

                    var eventJson = {
                        "tr_cbName": "showimage2",
                        "tr_paramKeyList": [
                            { "paramKey": "下载地址" },
                        ],
                    }
                   
                    loadJsonHtml("thead_passinfo_mingxi", "tbody_passinfo_mingxi", json, eventJson);
                    $('#myModal_mingxi').modal('show');
                }
            });
            
        }

        function passInfoClick(zplx) {
            bm_ajax("GetPassInfo", "&startTime=" + getTime("startTime") + "&endTime=" + getTime("endTime")+"&zplx=" + zplx, function (json) {
                if (json["return"]) {
                    var eventJson = {
                        "tr_cbName": "paddInfoMingXi",
                        "tr_paramKeyList": [
                            { "paramKey": "结果说明" },
                            { "paramKey": "照片类型" }
                        ],
                    }
                    loadJsonHtml("thead_passinfo", "tbody_passinfo", json, eventJson);     
                    $('#myModal').modal('show');
                } 
            });
        }

        function cbtest(id, name) {
            console.log("id" + id + "   name" + name);
        }

        function algPassListQuery() {

            bm_ajax("GetPassListInfo", "&startTime=" + getTime("startTime") + "&endTime=" + getTime("endTime"), function (json) {
                if (json["return"]) {

                    var eventJson = {
                        "tr_cbName": "passInfoClick",
                        "tr_paramKeyList": [
                            { "paramKey": "照片类型" }
                        ],
                    }
                    loadJsonHtml("thead_passlistinfo", "tbody_passlistinfo", json ,eventJson);   
                }
            });
        }

        function setTodayTime() {
            var now = new Date();
            var month = now.getMonth();//得到月份
            var date = now.getDate();//得到日期
            month = month + 1;
            if (month < 10) month = "0" + month;
            if (date < 10) date = "0" + date;

            var startTime = now.getFullYear() + "-" + month + "-" + date + "T00:00:00";
            var endTime = now.getFullYear() + "-" + month + "-" + date + "T23:59:59";
            var div_timeHtml = "起始时间:<input id=\"startTime\" type=\"datetime-local\" value=\"" + startTime + "\" />"
            div_timeHtml += "结束时间:<input id=\"endTime\" type=\"datetime-local\" value=\"" + endTime + "\" />"

            bm_html("div_time", div_timeHtml);
        }
       
    </script>

    <style>

    </style>
</head>
<body onload="setTodayTime(); algPassListQuery();">

    <div class="row" style="max-width:100%;">
        <div class="col-sm-12">

            <div id="div_updateFile" class="row">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h3 class="panel-title">
                            <div id="div_time">
                                起始时间:<input id="startTime" type="datetime-local" value="2015-09-24T13:59:59" />
                                结束时间:<input id="endTime" type="datetime-local" value="2015-09-24T13:59:59" />
                            </div>
                            <button type="button" class="btn btn-primary btn-xs" onclick="algPassListQuery();">刷新</button>
                        </h3>
                    </div>
                    <div class="panel-body">
                        <div class="panel panel-default">
                            <div class="panel-body">

                                <table class="table table-bordered table-striped table-hover table-condensed">
                                    <thead id="thead_passlistinfo"> </thead>
                                    <tbody id="tbody_passlistinfo"> </tbody>
                                </table>


                            </div>
                        </div>
                    </div>
                </div>
            </div>


        </div>
    </div>








































    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog" style="min-width:80%">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true" onclick="clearMsg();">
                        &times;
                    </button>
                    <h4 class="modal-title" id="myModalLabel">
                        Message
                    </h4>
                </div>
                <div class="modal-body" style="max-height:500px;overflow:auto;">
                    <table class="table table-bordered table-striped table-hover table-condensed">
                        <thead id="thead_passinfo"> </thead>
                        <tbody id="tbody_passinfo"> </tbody>
                    </table>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal" onclick="clearMsg();">
                        关闭
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="myModal_mingxi" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog" style="min-width:70%">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title" id="myModalLabel">
                        Message
                    </h4>
                </div>
                <div class="modal-body" style="max-height:500px;overflow:auto;">
                    <table class="table table-bordered table-striped table-hover table-condensed" >
                        <thead id="thead_passinfo_mingxi"> </thead>
                        <tbody id="tbody_passinfo_mingxi"> </tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal" ">
                        关闭
                    </button>
                </div>
            </div>
        </div>
    </div>



    <div class="modal fade" id="myModal_image" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog" style="min-width:60%;max-height:100%">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title" id="myModalLabel">
                        Message
                    </h4>
                </div>
                <div class="modal-body">
                    <img id="photoImage" style="max-width:60%;max-height:60%">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">
                        关闭
                    </button>
                </div>
            </div>
        </div>
    </div>

</body>
</html>
